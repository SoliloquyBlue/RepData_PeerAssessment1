---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
```{r}
if(!file.exists('activity.csv')){
  unzip("activity.zip")
}
activity <- read.csv('activity.csv', header=TRUE)
```

## What is mean total number of steps taken per day?
First we calculate the total steps per day using the summarize command of the dplyr package.  (We must load plyr first though.)

```{r}
require(plyr)
require(dplyr)
steps_per_day <- summarise(group_by(activity, date), sum(steps))
colnames(steps_per_day)[2] <- "total_steps"
```

Next we create the histogram:

```{r}
hist(steps_per_day$total_steps, col="darkblue", main="Histogram of steps per day", xlab="Steps Per Day")
```

And finally calculate the mean and median:
```{r}
mean <- mean(steps_per_day$total_steps, na.rm = TRUE)
median <- median(steps_per_day$total_steps, na.rm = TRUE)
```
So the mean is `mean` and the median is `median`.

Optional: rm(mean, median, steps_per_day)

## What is the average daily activity pattern?
I interpreted this question to mean we should get the average steps per day for each interval, so I'll construct a new data frame.

```{r}
activity <- activity[complete.cases(activity[,1]), ]
steps_by_interval <- summarise(group_by(activity, interval), average = mean(steps, na.rm = TRUE))
steps_by_interval$interval <- ts(steps_by_interval$interval)
plot(steps_by_interval$interval, steps_by_interval$average, type="l", 
     main="Average Daily Steps", 
     xlab="Intervals of 5 minutes", 
     ylab="Average steps")
```

max_value <- max(steps_by_interval$average)
which_interval <- subset(steps_by_interval, average == max_value, select = interval)

```{r}
dates <- as.character(activity$date)
times <- activity$interval
times <- sprintf("%02d", times)
times <- paste("00", times, sep=":")

activity$datetime <- as.POSIXlt(paste(dates, times), format="%Y-%m-%d %H:%M", tz="GMT")
rm(dates, times)

```

Construct the plot:
```{r}
```
To get the axis to format nicely I added the following to my ggplot2 commands:

+ scale_x_chron(format="%H:%M") 



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
